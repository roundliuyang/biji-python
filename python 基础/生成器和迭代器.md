# 生成器和迭代器

>[生成器和迭代器](https://pythonhowto.readthedocs.io/zh-cn/latest/iterator.html)

## 生成器

### 生成器表达式

在生成列表和字典时，可以通过推导表达式完成。只要把推导表达式中的中括号换成小括号就成了生成器表达式。

```python
list0 = [x * x for x in range(5)]
print(list0)

list_generator0 = (x * x for x in range(5))
print(list_generator0)

list_generator1 = (x * x for x in range(5000000))
print(sys.getsizeof(list_generator0))
print(sys.getsizeof(list_generator1))

>>>
[0, 1, 4, 9, 16]
<generator object <genexpr> at 0x000002C7B9955B48>
88
88
```

显然生成器对象的大小不会因为生成元素的上限个数而增大，此外不能够像列表被打印出来，那么如何获取通过生成器获取每一个元素呢？ 借助 Python 内建方法 next()：

```python
list_generator0 = (x * x for x in range(3))
print(next(list_generator0))
print(next(list_generator0))
print(next(list_generator0))
print(next(list_generator0)) # 触发 StopIteration 异常

>>>
0
1
4
StopIteration
```

每次调用 next() 方法时，总是根据最后的值和生成器给出的生成方法来计算下一个值。直到最后一个元素，抛出 StopIteration 异常。generator 也是可迭代对象，通常不会使用 next() 来逐个获取元素，而是使用 for in，它自动在遇到 StopIteration 异常时结束循环。

```python
list_generator0 = (x * x for x in range(3))
print(isinstance(list_generator0, Iterable))
for i in list_generator0:
    print(i)

>>>
True
0
1
4
```









